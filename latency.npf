%info
Latency

%variables
FSIZE={128}
KSIZE={32}
REQUEST_RATE={150}
THREADS={2}

%late_variables
SERVER="localhost:2241"
PORT=2241
TIME=5

%init
make clean
make all

%script
./server -j $THREADS -s $FSIZE -p $PORT

%script waitfor=server_listening
result=$(./client -k $KSIZE -r $REQUEST_RATE -t $TIME $SERVER | grep -ioE "Response times: +")
echo "RESULT-LATENCY $result"

